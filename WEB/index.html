<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Список задач</title>
</head>
<body>
    <h1>Список задач</h1>
    <a href="add.html">Добавить задачу</a>
    
    <table border="1"> 
        <thead>
            <tr> <!-- Строка заголовка таблицы -->
                <th>Задачи</th>
                <th>В работе</th>
                <th>Выполненные</th> <!-- Ячейки заголовка таблицы -->
                
            </tr>
        </thead>
        <tbody id="taskTableBody">
            <!-- Список задач -->
        </tbody>
    </table>
    
    <script>
        function loadTasks() {
            const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            const taskTableBody = document.getElementById("taskTableBody");
            taskTableBody.innerHTML = ""; // Очистить таблицу перед загрузкой

            tasks.forEach((task, index) => {
                const row = document.createElement("tr"); //Перебирает каждую задачу, создавая строку <tr> и добавляя следующие ячейки:

                const taskCell = document.createElement("td");
                taskCell.textContent = task.name;
                row.appendChild(taskCell);

                const inProgressCell = document.createElement("td"); //создается новая ячейка
                const inProgressCheckbox = document.createElement("input"); //cоздается элемент <input> типа checkbox
                inProgressCheckbox.type = "checkbox"; //флажок
                inProgressCheckbox.checked = task.inProgress;
                inProgressCheckbox.onchange = () => toggleTaskInProgress(index); // При изменении состояния флажка вызывается функция
                inProgressCell.appendChild(inProgressCheckbox); //добавляет созданный флажок внутрь ячейки таблицы
                row.appendChild(inProgressCell);

                const doneCell = document.createElement("td");
                const doneCheckbox = document.createElement("input");
                doneCheckbox.type = "checkbox";
                doneCheckbox.checked = task.done;
                doneCheckbox.onchange = () => toggleTaskDone(index); // При изменении состояния флажка вызывается функция
                doneCell.appendChild(doneCheckbox);
                row.appendChild(doneCell);

                const deleteCell = document.createElement("td");
                const deleteButton = document.createElement("button");
                deleteButton.textContent = "Удалить";
                deleteButton.onclick = () => deleteTask(index); // При клике вызывается функция
                deleteCell.appendChild(deleteButton);
                row.appendChild(deleteCell);

                taskTableBody.appendChild(row);
            });
        }

        function toggleTaskInProgress(index) {
            const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            tasks[index].inProgress = !tasks[index].inProgress;
            localStorage.setItem("tasks", JSON.stringify(tasks));
            loadTasks();
        }

        function toggleTaskDone(index) {
            const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            tasks[index].done = !tasks[index].done;
            localStorage.setItem("tasks", JSON.stringify(tasks));
            loadTasks();
        }

        function deleteTask(index) {
            const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
            tasks.splice(index, 1); // удаляет задачу
            localStorage.setItem("tasks", JSON.stringify(tasks));
            loadTasks();
        }

        window.onload = loadTasks;
    </script>
</body>
</html>
